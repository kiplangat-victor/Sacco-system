<mat-card>
	<mat-card-header class="breadcrumb">
		<div>
			<a routerLink="/system">Dashboard / </a>
			<a routerLink="/system/product/overdrafts/maintenance">Over-Draft Product Maintenenace / </a>
			Over-Draft Product
		</div>
	</mat-card-header>
	<div *ngIf="loading">
		<p><small>Loading, please wait...</small></p>
		<p>
			<mat-progress-bar mode="indeterminate"></mat-progress-bar>
		</p>
	</div>
	<div class="row">
		<div class="col-md-5 col-sm-12">
			<div class="row">
				<div class="col-md-6 col-sm-12">
					<h4>Function:- <strong>{{this.fmData.function_type}}</strong> </h4>
				</div>
				<div class="col-md-6 col-sm-12">
					<h4>ODA Code:- <strong>{{this.fmData.productCode}}</strong></h4>
				</div>
			</div>
		</div>
		<div class="col-md-7 col-sm-12 row" *ngIf="onShowResults">
			<div class="row" *ngIf="this.results">
				<div class="col-md-4 col-sm-12">
					<h4>Posted ON:- <strong>{{this.results.postedTime | date }}</strong></h4>
				</div>
				<div class="col-md-4 col-sm-12">
					<h4>Posted BY:- <strong>{{this.results.postedBy}}</strong></h4>
				</div>
				<div class="col-md-4 col-sm-12">
					<h4>Verification:- <strong>{{this.results.verifiedFlag}}</strong></h4>
				</div>
			</div>
		</div>
	</div>
	<mat-divider></mat-divider>
	<br>
	<div class="container-fluid">
		<form action="" class="form" [formGroup]="formData" novalidate>
			<mat-tab-group mat-align-tabs="center">
				<mat-tab class="mat-tab" label="General Details">
					<br>
					<div class="row">
						<div class="col-md-6 col-sm-12">
							<div class="input-group mb-3">
								<div class="col-md-6 col-sm-12 form-column">
									<label class="start pull-left">Effective From Date</label>
										<span class="text-danger" *ngIf="onShowWarning">*</span>
								</div>
								<div class="col-md-6 col-sm-12 form-column">
									<input [matDatepicker]="effective_from_date" formControlName="effective_from_date"
										class="form-control" [ngClass]="{ 'is-invalid': submitted && f.effective_from_date.errors }">
									<span *ngIf="onShowDate" color="primary">
										<mat-datepicker-toggle matSuffix [for]="effective_from_date"></mat-datepicker-toggle>
									</span>
									<mat-datepicker color="primary" #effective_from_date></mat-datepicker>
								</div>
							</div>
						</div>
						<div class="col-md-6 col-sm-12">
							<div class="input-group mb-3">
								<div class="col-md-6 col-sm-12 form-column">
									<label class="start pull-left">Effective To Date</label>
										<span class="text-danger" *ngIf="onShowWarning">*</span>
								</div>
								<div class="col-md-6 col-sm-12 form-column">
									<input [matDatepicker]="effective_to_date" formControlName="effective_to_date" class="form-control"
									[ngClass]="{ 'is-invalid': submitted && f.effective_to_date.errors }">
									<span *ngIf="onShowDate" color="primary">
										<mat-datepicker-toggle matSuffix [for]="effective_to_date"></mat-datepicker-toggle>
									</span>
									<mat-datepicker color="primary" #effective_to_date></mat-datepicker>
								</div>
							</div>
						</div>

						<div class="col-md-6 col-sm-12">
							<div class="form-group">
								<div class="col-md-6 col-sm-12 form-column">
									<label class="start pull-left">Number Generation <span class="text-danger"
											*ngIf="onShowWarning">? *</span></label>
								</div>
								<div class="col-md-6 col-sm-12 form-column">
									<mat-radio-group (change)="handleChange($event)" class="pull-right" aria-label="Select an option"
										formControlName="acid_generation"
										[ngClass]="{ 'is-invalid': submitted && f.acid_generation.errors }">
										<mat-radio-button value="Y" color="primary">YES</mat-radio-button>
										<mat-radio-button value="N" color="warn">NO</mat-radio-button>
									</mat-radio-group>
								</div>
							</div>
						</div>
						<div class="col-md-6 col-sm-12" *ngIf="showAcidStructure">
							<div class="form-group">
								<div class="col-md-6 col-sm-12 form-column">
									<label>Acid Structure</label>
								</div>
								<div class="col-md-6 col-sm-12 form-column">
									<input type="text" formControlName="acid_structure" class="form-control"
										oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);"
										maxlength="40" minlength="1" />
								</div>
							</div>
						</div>
						<div class="col-md-6 col-sm-12" *ngIf="showAcidStructure">
							<div class="form-group">
								<div class="col-md-6 col-sm-12 form-column ">
									<label>Increment</label>
								</div>
								<div class="col-md-6 col-sm-12 form-column">
									<input type="number" formControlName="increment" class="form-control"
										oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);"
										maxlength="20" minlength="1" />
								</div>
							</div>
						</div>
						<div class="col-md-6 col-sm-12" *ngIf="showAcidStructure">
							<div class="form-group">
								<div class="col-md-6 col-sm-12 form-column">
									<label class="start pull-left">Running No. Size<span class="text-danger" *ngIf="onShowWarning">*</span></label>
								</div>
								<div class="col-md-6 col-sm-12 form-column">
									<input type="number" formControlName="running_no_size" placeholder="" class="form-control"
										oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);"
										maxlength="20" minlength="1">
								</div>
							</div>
						</div>
						<div class="col-md-6 col-sm-12">
							<div class="form-group">
								<div class="col-md-6 col-sm-12 form-column">
									<label class="start pull-left">Interest Table Code<span class="text-danger"
											*ngIf="onShowWarning">*</span></label>
								</div>
								<div class="col-md-6 col-sm-12 form-column">
									<input type="text" formControlName="interest_table_code" placeholder="" class="form-control"
										[ngClass]="{ 'is-invalid': submitted && f.interest_table_code.errors }">
									&nbsp; &nbsp;
									<mat-icon color="primary" *ngIf="showSearch" (click)="intTableCodeLookup()">search</mat-icon>
								</div>
							</div>
						</div>
						<div class="col-md-6 col-sm-12">
							<div class="form-group">
								<div class="col-md-6 col-sm-12 form-column">
									<label class="start pull-left">Advance Int. Account<span class="text-danger"
											*ngIf="onShowWarning">*</span></label>
								</div>
								<div class="col-md-6 col-sm-12 form-column">
									<input type="text" formControlName="advance_int_ac" placeholder="" class="form-control"
										[ngClass]="{ 'is-invalid': submitted && f.advance_int_ac.errors }">
									&nbsp; &nbsp;
									<mat-icon color="primary" *ngIf="showSearch" (click)="advanceAccountLookup()">search</mat-icon>
								</div>
							</div>
						</div>
						<div class="col-md-6 col-sm-12">
							<div class="form-group">
								<div class="col-md-6 col-sm-12 form-column">
									<label class="start pull-left">Int Receivable Account<span class="text-danger"
											*ngIf="onShowWarning">*</span></label>
								</div>
								<div class="col-md-6 col-sm-12 form-column">
									<input type="text" formControlName="int_receivable_ac" placeholder="" class="form-control"
										[ngClass]="{ 'is-invalid': submitted && f.int_receivable_ac.errors }">
									&nbsp; &nbsp;
									<mat-icon color="primary" *ngIf="showSearch" (click)="intAccountLookup()">search</mat-icon>
								</div>
							</div>
						</div>

						<div class="col-md-6 col-sm-12">
							<div class="form-group">
								<div class="col-md-6 col-sm-12 form-column">
									<label class="start pull-left">Penal Int. Receivable Account<span class="text-danger"
											*ngIf="onShowWarning">*</span></label>
								</div>
								<div class="col-md-6 col-sm-12 form-column">
									<input type="text" formControlName="penal_int_receivable_ac" placeholder="" class="form-control"
										[ngClass]="{ 'is-invalid': submitted && f.penal_int_receivable_ac.errors }">
									&nbsp; &nbsp;
									<mat-icon color="primary" *ngIf="showSearch" (click)="penalIntAccountLookup()">search</mat-icon>
								</div>
							</div>
						</div>
						<div class="col-md-6 col-sm-12">
							<div class="form-group">
								<div class="col-md-6 col-sm-12 form-column">
									<label class="start pull-left">Penal Receivable Account<span class="text-danger"
											*ngIf="onShowWarning">*</span></label>
								</div>
								<div class="col-md-6 col-sm-12 form-column">
									<input type="text" formControlName="penal_receivable_ac" placeholder="" class="form-control"
										[ngClass]="{ 'is-invalid': submitted && f.penal_receivable_ac.errors }">
									&nbsp; &nbsp;
									<mat-icon color="primary" *ngIf="showSearch" (click)="penalAccountLookup()">search</mat-icon>
								</div>
							</div>
						</div>
						<div class="col-md-6 col-sm-12">
							<div class="form-group">
								<div class="col-md-6 col-sm-12 form-column">
									<label class="start pull-left">P&L. Account<span class="text-danger" *ngIf="onShowWarning">*</span></label>
								</div>
								<div class="col-md-6 col-sm-12 form-column">
									<input type="text" formControlName="pl_ac" placeholder="" class="form-control"
										[ngClass]="{ 'is-invalid': submitted && f.pl_ac.errors }">
									&nbsp; &nbsp;
									<mat-icon color="primary" *ngIf="showSearch" (click)="plAccountLookup()">search</mat-icon>
								</div>
							</div>
						</div>
						<div class="col-md-6 col-sm-12">
							<div class="form-group">
								<div class="col-md-6 col-sm-12 form-column">
									<label class="start pull-left">Princ. Receivable Account<span class="text-danger"
											*ngIf="onShowWarning">*</span></label>
								</div>
								<div class="col-md-6 col-sm-12 form-column">
									<input type="text" formControlName="princ_receivable_ac" placeholder="" class="form-control"
										[ngClass]="{ 'is-invalid': submitted && f.princ_receivable_ac.errors }">
									&nbsp; &nbsp;
									<mat-icon color="primary" *ngIf="showSearch" (click)="princAccountLookup()">search</mat-icon>
								</div>
							</div>
						</div>
						<div class="col-md-6 col-sm-12">
							<div class="form-group">
								<div class="col-md-6 col-sm-12 form-column">
									<label class="start pull-left">P&L. Account CCY.<span class="text-danger"
											*ngIf="onShowWarning">*</span></label>
								</div>
								<div class="col-md-6 col-sm-12 form-column">
									<mat-radio-group class="pull-right" aria-label="Select an option" formControlName="pl_ac_ccy"
										[ngClass]="{ 'is-invalid': submitted && f.pl_ac_ccy.errors }">
										<mat-radio-button value="A/c. CCY" color="primary">A/c. CCY</mat-radio-button>
										<mat-radio-button value="Home CCY" color="warn">Home CCY</mat-radio-button>
									</mat-radio-group>
								</div>
							</div>
						</div>
						<div class="col-md-6 col-sm-12">
							<div class="form-group">
								<div class="col-md-6 col-sm-12 form-column">
									<label class="start pull-left">Collect Ledger Fee ?</label>
								</div>
								<div class="col-md-6 col-sm-12 form-column">
									<mat-radio-group (change)="handleFeeChange($event)" class="pull-right" aria-label="Select an option"
										formControlName="collectLedgerFee">
										<mat-radio-button [value]="true" color="primary">YES</mat-radio-button>
										<mat-radio-button [value]="false">NO</mat-radio-button>
									</mat-radio-group>
								</div>
							</div>
						</div>
						<div class="col-md-6 col-sm-12" *ngIf="showledgerFeeEventIdCode">
							<div class="form-group">
								<div class="col-md-6 col-sm-12 form-column">
									<label class="start">Ledger Fee Code</label>
								</div>
								<div class="col-md-6 col-sm-12 form-column">
									<input type="text" formControlName="ledgerFeeEventIdCode" class="form-control">
									&nbsp; &nbsp;
									<mat-icon *ngIf="showSearch" color="primary" (click)="ledgerFeeEventIdCodeLookup()">
										search</mat-icon>
								</div>
							</div>
						</div>
					</div>
					<br>
					<button mat-raised-button type="submit" class="pull-left bg-secondary text-white"
						routerLink="/system/product/overdrafts/maintenance">BACK</button>
				</mat-tab>
				<mat-tab class="mat-tab" label="GL Suheads">
					<br>
					<form [formGroup]="glsubheadsForm" *ngIf="showglsubheadsForm">
						<div class="row">
							<div class="col-md-6 col-sm-12">
								<div class="form-group">
									<div class="col-md-6 col-sm-12 form-column">
										<label class="start">GL Subhead Code</label>
									</div>
									<div class="col-md-6 col-sm-12 form-column">
										<input type="text" formControlName="gl_subhead" class="form-control">
										&nbsp; &nbsp;
										<mat-icon *ngIf="showSearch" color="primary" (click)="glSubheadLookup()">
											search</mat-icon>
									</div>
								</div>
							</div>
							<div class="col-md-6 col-sm-12">
								<div class="form-group">
									<div class="col-md-6 col-sm-12 form-column">
										<label class="start">GL Code</label>
									</div>
									<div class="col-md-6 col-sm-12 form-column">
										<input readonly type="text" formControlName="gl_code" class="form-control">
									</div>
								</div>
							</div>
							<div class="col-md-6 col-sm-12">
								<div class="form-group">
									<div class="col-md-6 col-sm-12 form-column">
										<label class="start">Gl Subhead Description</label>
									</div>
									<div class="col-md-6 col-sm-12 form-column">
										<textarea readonly formControlName="gl_subhead_description"
											class="form-control"></textarea>
									</div>
								</div>
							</div>
						</div>
						<div *ngIf="showButtons">
							<button *ngIf="addButton" (click)="addglsubheads()"
								class="pull-right btn btn-success btn-sm"
								[disabled]="!glsubheadsForm.valid || disableAddButton" mat-raised-button color="primary"
								type="button">
								Add GL Subhead
							</button>
							<button *ngIf="editButton" (click)="updateglsubheads()"
								class="pull-right btn btn-primary btn-sm"
								[disabled]="!glsubheadsForm.valid || disableAddButton" mat-raised-button color="primary"
								type="button">
								Update GL Subhead
							</button>
						</div>
					</form>
					<br>
					<div class="row table-action-row">
						<div class="on-mobile-hide col-md-6 col-sm-12">
							<strong>GL Subheads List</strong>
						</div>
						<div class="col-md-6 col-sm-12">
							<input class="pull-right search form-control" (keyup)="applyglsubheadsFilter($event)"
								placeholder="Search..." #input />
						</div>
					</div>
					<br>
					<div class="table-row">
						<table mat-table matSort matTableExporter [dataSource]="glsubheadsDataSource">
							<ng-container matColumnDef="index">
								<th mat-header-cell *matHeaderCellDef mat-sort-header> # </th>
								<td mat-cell *matCellDef="let element; let i = index">{{i + 1}}</td>
							</ng-container>
							<ng-container matColumnDef="gl_subhead">
								<th mat-header-cell *matHeaderCellDef mat-sort-header>GL Subhead Code</th>
								<td mat-cell *matCellDef="let row">{{ row.gl_subhead}}</td>
							</ng-container>
							<ng-container matColumnDef="gl_code">
								<th mat-header-cell *matHeaderCellDef mat-sort-header>GL Code
								<td mat-cell *matCellDef="let row">{{ row.gl_code}}</td>
							</ng-container>
							<ng-container matColumnDef="gl_subhead_description">
								<th mat-header-cell *matHeaderCellDef mat-sort-header>Description</th>
								<td mat-cell *matCellDef="let row">{{ row.gl_subhead_description }}</td>
							</ng-container>
							<ng-container matColumnDef="actions">
								<th mat-header-cell *matHeaderCellDef mat-sort-header>Action</th>
								<td mat-cell *matCellDef="let row">
									<button [disabled]="disableActions" mat-icon-button color="primary"
										(click)="editglsubheads(row)">
										<mat-icon>edit</mat-icon>
									</button>
									<button [disabled]="disableActions" mat-icon-button  (click)="deleteglsubheads(row)"
										color="warn">
										<mat-icon>delete</mat-icon>
									</button>
								</td>
							</ng-container>
							<tr mat-header-row *matHeaderRowDef="glsubheadsColumns"></tr>
							<tr mat-row *matRowDef="let row; columns: glsubheadsColumns;"></tr>
							<tr class="mat-row" *matNoDataRow>
								<td class="mat-cell" colspan="4">No data matching the filter "{{input.value}}"</td>
							</tr>
						</table>
					</div>
					<mat-paginator [pageSizeOptions]="[7, 20, 30, 40, 50, 100]"
						aria-label="Select page"></mat-paginator>
					<br>
					<hr>
					<button mat-raised-button type="submit" class="pull-left bg-secondary text-white"
						routerLink="/system/product/overdrafts/maintenance">BACK</button>
					<button *ngIf="!hideBtn" class="pull-right" mat-raised-button [color]="btnColor" type="submit" (click)="onSubmit()">
						<span *ngIf="loading" class="spinner-border spinner-border-sm mr-1"></span>{{btnText}}
					</button>
					<br>
				</mat-tab>
			</mat-tab-group>
		</form>
	</div>
</mat-card>
